<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <title>템핏 TempFit - 날씨 기반 의상 추천</title>
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
    <link href="css/styles.css" rel="stylesheet" />
  </head>
  <body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <div class="container px-5">
        <a class="navbar-brand" href="/">
          <img src="/assets/tempfit-logo.png" alt="TempFit" style="height: 38px" />
        </a>
        <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
          <li class="nav-item"><a class="nav-link active" aria-current="page" href="/community/list">게시글</a></li>
        </ul>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
            <li class="nav-item"><a class="nav-link" href="#!">회원가입</a></li>
            <li class="nav-item"><a class="nav-link" href="#!">로그인</a></li>
          </ul>
        </div>
      </div>
    </nav>

<div class="container px-4 px-lg-5">
  <div class="row gx-4 gx-lg-5 align-items-start my-5">
    <!-- 왼쪽 50%: 날씨카드+시간대별온도 -->
    <div class="col-12 col-lg-6 d-flex flex-column h-100">
      <div class="card shadow-sm mb-4 flex-grow-1" style="width: 100%;">
        <div class="card-body text-center">
          <div id="weather-icon" style="font-size: 3rem; margin-bottom: 8px"></div>
          <div id="weather-sky" class="fw-bold" style="font-size: 1.1rem; color: #226be7">-</div>
          <div id="weather-desc" style="margin-bottom: 2px">-</div>
          <div id="weather-temp" style="font-size: 2.4rem; font-weight: bold; margin-bottom: 5px">-℃</div>
          <div class="text-secondary" id="weather-date">-</div>
          <div class="text-secondary" id="weather-time">-</div>
          <div id="weather-location" class="mt-2"></div>
        </div>
      </div>
      <div class="card text-white bg-secondary my-1 py-4 text-center" style="width: 100%;">
        <div class="card-body">
          <p class="text-white m-0">시간대별 온도</p>
        </div>
      </div>
    </div>
    <!-- 오른쪽 50%: 추천 코디 -->
<div class="col-12 col-lg-6 d-flex flex-column h-100">
  <h1 class="font-weight-light mt-5 mb-3" id="clothing-guide-head" style="font-size:2.4rem;">
    오늘의 추천 코디
  </h1>
  <!-- 남성 코디 -->
  <h3 class="mb-2 mt-4" style="font-weight: bold;">남성 코디</h3>
  <div id="clothing-guide-male" style="display: flex; gap: 32px; margin-bottom: 24px"></div>
  <!-- 여성 코디 -->
  <h3 class="mb-2 mt-4" style="font-weight: bold;">여성 코디</h3>
  <div id="clothing-guide-female" style="display: flex; gap: 32px; margin-bottom: 24px"></div>
</div>

      <!-- Content Row (카드 4개) : 같은 container 안에 위치 -->
      <div class="row gx-4 gx-lg-5">
        <div class="col-md-3 mb-5">
          <div class="card h-100">
            <div class="card-body">
              <h2 class="card-title">캐주얼</h2>
              <p class="card-text">
                Lorem ipsum dolor sit amet, consectetur adipisicing elit. Rem magni quas ex numquam, maxime minus quam
                molestias corporis quod, ea minima accusamus.
              </p>
            </div>
            <div class="card-footer"><a class="btn btn-primary btn-sm" href="#!">More Info</a></div>
          </div>
        </div>
        <div class="col-md-3 mb-5">
          <div class="card h-100">
            <div class="card-body">
              <h2 class="card-title">포멀</h2>
              <p class="card-text">
                Lorem ipsum dolor sit amet, consectetur adipisicing elit. Quod tenetur ex natus at dolorem enim!
                Nesciunt pariatur voluptatem sunt quam eaque, vel, non in id dolore voluptates quos eligendi labore.
              </p>
            </div>
            <div class="card-footer"><a class="btn btn-primary btn-sm" href="#!">More Info</a></div>
          </div>
        </div>
        <div class="col-md-3 mb-5">
          <div class="card h-100">
            <div class="card-body">
              <h2 class="card-title">스트리트</h2>
              <p class="card-text">
                Lorem ipsum dolor sit amet, consectetur adipisicing elit. Rem magni quas ex numquam, maxime minus quam
                molestias corporis quod, ea minima accusamus.
              </p>
            </div>
            <div class="card-footer"><a class="btn btn-primary btn-sm" href="#!">More Info</a></div>
          </div>
        </div>
        <div class="col-md-3 mb-5">
          <div class="card h-100">
            <div class="card-body">
              <h2 class="card-title">아웃도어</h2>
              <p class="card-text">
                Lorem ipsum dolor sit amet, consectetur adipisicing elit. Quod tenetur ex natus at dolorem enim!
                Nesciunt pariatur voluptatem sunt quam eaque, vel, non in id dolore voluptates quos eligendi labore.
              </p>
            </div>
            <div class="card-footer"><a class="btn btn-primary btn-sm" href="#!">More Info</a></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer-->
    <footer class="py-5 bg-dark">
      <div class="container px-4 px-lg-5">
        <p class="m-0 text-center text-white">Copyright &copy; TempFit 2025</p>
      </div>
    </footer>
    <!-- Bootstrap core JS-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/scripts.js"></script>

    <!-- 위치 + 날씨 + 추천 JS -->
      <script>
    window.addEventListener("DOMContentLoaded", function () {
  // 1. 위치정보 받아오기
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(
      function (pos) {
        const lat = pos.coords.latitude;
        const lon = pos.coords.longitude;

        // 2. 날씨 API 호출 (온도 받아오기)
        fetch(`/api/weather/current?lat=${lat}&lon=${lon}`)
          .then(res => res.json())
          .then(weatherData => {
            // 온도 표시 (기존 날씨카드용)
            document.getElementById("weather-sky").textContent = weatherData.sky || "-";
            document.getElementById("weather-desc").textContent = weatherData.rainType || "-";
            document.getElementById("weather-temp").textContent = weatherData.temp !== undefined ? weatherData.temp : "-";
            document.getElementById("weather-date").textContent = weatherData.fcstDate || "-";
            document.getElementById("weather-time").textContent = weatherData.fcstTime || "-";
            document.getElementById("weather-location").textContent = weatherData.location || "";

            let tempNum = parseInt(weatherData.temp);

            // 3. 온도로 남/여 코디 추천 API 호출
            fetch(`/api/coordi/guide?temp=${tempNum}`)
              .then(res => res.json())
              .then(data => {
                renderGuide("clothing-guide-male", data.male);
                renderGuide("clothing-guide-female", data.female);
              })
              .catch(() => {
                document.getElementById("clothing-guide-male").innerText = "추천 코디 정보를 가져오지 못했습니다";
                document.getElementById("clothing-guide-female").innerText = "추천 코디 정보를 가져오지 못했습니다";
              });
          })
          .catch(() => {
            document.getElementById("weather-temp").textContent = "날씨 정보를 가져오지 못했습니다";
          });
      },
      function (error) {
        document.getElementById("weather-temp").textContent = "위치 권한을 허용해 주세요!";
      }
    );
  } else {
    document.getElementById("weather-temp").textContent = "브라우저가 위치정보를 지원하지 않습니다.";
  }

  // 공통 렌더 함수
  function renderGuide(divId, data) {
    const guideDiv = document.getElementById(divId);
    guideDiv.innerHTML = "";
    ["top", "bottom", "shoes"].forEach(part => {
      if (data[part]) {
        guideDiv.innerHTML += `
          <div style="text-align:center;">
            <img src="${data[part].imageUrl}" alt="${data[part].name}" width="150" height="150"
              style="border-radius:10px; border:1px solid #ddd; background:#fafafa;"/><br/>
            <b>${part === "top" ? "상의" : part === "bottom" ? "하의" : "신발"}</b><br/>
            <span style="font-size:18px;">${data[part].name}</span>
          </div>
        `;
      }
    });
  }
});
    </script>
  </body>
</html>
